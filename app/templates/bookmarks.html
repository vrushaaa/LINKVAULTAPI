{% extends "base.html" %}
{% block title %}My Bookmarks â€¢ LinkVault{% endblock %}

{% block content %}
<h1>My Bookmarks ({{ pagination.total }})</h1>

<a href="{{ url_for('bookmarks_api.create_bookmark_get') }}" style="float:right; color:#c1e328;">+ Add New</a>

<div class="bookmarks-grid">
    {% for b in bookmarks %}
    <div class="bookmark-card">
        <h3>{{ b.title or 'Untitled' }}</h3>
        <p><a href="{{ b.url }}" target="_blank">{{ b.url }}</a></p>
        <p><strong>Short:</strong> <a href="{{ url_for('short.redirect_short', short_code=b.short_url) }}" target="_blank">
            {{ url_for('short.redirect_short', short_code=b.short_url, _external=True) }}
        </a></p>
        {% if b.notes %}
            <p><em>{{ b.notes }}</em></p>
        {% endif %}
        <div class="tags">
            {% for tag in b.tags %}
                <span class="tag">{{ tag.name }}</span>
            {% endfor %}
        </div>
        <small>Added: {{ b.created_at.strftime('%Y-%m-%d %H:%M') }} IST</small>

        <!-- DELETE BUTTON -->
        <button onclick="if(confirm('Are you sure you want to delete this bookmark?')) { fetch('{{ url_for('bookmarks_api.delete_bookmark', bookmark_id=b.id) }}', { method: 'POST' }).then(() => location.reload()); }" 
                style="margin-top:10px; background:#ff4444; color:white; border:none; padding:8px 12px; border-radius:8px; cursor:pointer; font-weight:bold; font-size:12px;">
            Delete
        </button>
    </div>
    {% endfor %}
</div>


<!-- Pagination -->
<div style="text-align:center; margin:40px 0;">
    {% if pagination.has_prev %}
        <a href="{{ url_for('bookmarks_api.list_bookmarks', page=pagination.prev_num) }}">Previous</a>
    {% endif %}
    <span> Page {{ pagination.page }} of {{ pagination.pages }} </span>
    {% if pagination.has_next %}
        <a href="{{ url_for('bookmarks_api.list_bookmarks', page=pagination.next_num) }}">Next</a>
    {% endif %}
</div>
{% endblock %}